import{_ as x,c as i,b as v,a as t,F as p,e as b,f,t as l,r as y,o as c,d as g,g as C,v as L}from"./index-6yo97Gfc.js";var V={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"peggy123",VITE_TEXT:"這是部署的環境",BASE_URL:"/vite-router/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:r,VITE_PATH:u}=V,T={data(){return{cartData:[],addCartQty:1,final_total:0,total:0,isLoading:!0}},methods:{showCart(){this.isLoading=!0;const a=`${r}/api/${u}/cart`;this.$http.get(a).then(e=>{this.cartData=e.data.data.carts,this.final_total=e.data.data.final_total,this.total=e.data.data.total}).catch(e=>{alert(e.response.data.message)}).finally(()=>{this.isLoading=!1})},changeCart(a,e){this.isLoading=!0,this.$http.put(`${r}/api/${u}/cart/${a.id}`,{data:{product_id:a.product_id,qty:parseInt(e.target.value)}}).then(n=>{this.showCart()}).catch(n=>{alert(n.response.data.message)}).finally(()=>{this.isLoading=!1})},deleteItem(a,e){this.isLoading=!0;let n=`${r}/api/${u}/carts`;a==="single"&&(n=`${r}/api/${u}/cart/${e.id}`),this.$http.delete(n).then(_=>{this.showCart()}).catch(_=>{alert(_.response.data.message)}).finally(()=>{this.isLoading=!1})}},mounted(){this.showCart()}},D={class:"container mt-5 pt-5"},E={class:"text-end"},$={class:"table align-middle"},I=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",{class:"text-end"},"單價")])],-1),k=["onClick"],w=t("div",{class:"text-success"}," 已套用優惠券 ",-1),U={class:"input-group input-group-sm"},R={class:"input-group mb-3"},B=["onUpdate:modelValue","onChange"],N={class:"input-group-text",id:"basic-addon2"},S={class:"text-end"},q=t("br",null,null,-1),A=t("small",{class:"text-success"},"折扣價：",-1),P={key:0},F=t("p",{class:"text-center mb-0"},"購物車內還沒有商品",-1),H=[F],M=t("td",{colspan:"3",class:"text-end"},"總計",-1),O={class:"text-end"},Q=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),X={class:"text-end text-success"};function j(a,e,n,_,o,h){const m=y("VueLoading");return c(),i(p,null,[v(m,{active:o.isLoading},null,8,["active"]),t("div",D,[t("div",E,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:e[0]||(e[0]=s=>h.deleteItem("all"))},"清空購物車")]),t("table",$,[I,t("tbody",null,[o.cartData?(c(),i(p,{key:0},[(c(!0),i(p,null,b(o.cartData,s=>(c(),i("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:d=>h.deleteItem("single",s)}," x ",8,k)]),t("td",null,[g(l(s.product.title)+" ",1),w]),t("td",null,[t("div",U,[t("div",R,[C(t("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":d=>s.qty=d,onChange:d=>h.changeCart(s,d)},null,40,B),[[L,s.qty]]),t("span",N,l(s.product.unit),1)])])]),t("td",S,[g(l(s.product.origin_price)+" ",1),q,A,g(" "+l(s.product.price),1)])]))),128)),o.cartData.length<1?(c(),i("div",P,H)):f("",!0)],64)):f("",!0)]),t("tfoot",null,[t("tr",null,[M,t("td",O,l(o.total),1)]),t("tr",null,[Q,t("td",X,l(o.final_total),1)])])])])],64)}const G=x(T,[["render",j]]);export{G as default};
